<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
	<head>
	    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
	    <title>{% block title %}AASG Submission Tracking{% endblock %}</title>
		<link rel="stylesheet" type="text/css" href="{{ media_url }}aasgtrack/ext-3.2.1/resources/css/ext-all.css" />
		<link rel="stylesheet" type="text/css" href="{{ media_url }}aasgtrack/GeoExt/resources/css/geoext-all-debug.css" />
	    {% block styles %}{% endblock %}	
    	<script src="{{ media_url }}aasgtrack/ext-3.2.1/adapter/ext/ext-base.js" type="text/javascript"></script>
		<script src="{{ media_url }}aasgtrack/ext-3.2.1/ext-all.js"  type="text/javascript"></script>
		<script src="{{ media_url }}aasgtrack/OpenLayers-2.10/OpenLayers.js" type="text/javascript"></script>
		<script src="{{ media_url }}aasgtrack/GeoExt/lib/GeoExt.js" type="text/javascript"></script>
		<script type="text/javascript">
			var globalMap;
			
			function mapEvent(event) {
				alert(globalMap.getExtent())
			}	
					
		    Ext.onReady(function() {
				// Build customized mapOptions for each map
				//  Setting resolutions to just one value sets the zoom-scale to that value    				   		     
    			var continentalMapOptions = { projection: new OpenLayers.Projection("EPSG:3857"),
	    				   		   controls: new OpenLayers.Control.Attribution(),
	    				   		   maxExtent: new OpenLayers.Bounds(-20037508.34,-20037508.34,20037508.34,20037508.34),
	    				   		   maxResolution: 156543.0339,
	    				   		   resolutions: [ 6650 ],
	    				   		   units: "m", 
    				   		     };
    			
    			var alaskaMapOptions = { projection: new OpenLayers.Projection("EPSG:3857"),
	    				   		   controls: new OpenLayers.Control.Attribution(),
	    				   		   maxExtent: new OpenLayers.Bounds(-20037508.34,-20037508.34,20037508.34,20037508.34),
	    				   		   maxResolution: 156543.0339,
	    				   		   resolutions: [ 25650 ],
	    				   		   units: "m", 
    				   		     };
    			
    			var hawaiiMapOptions = { projection: new OpenLayers.Projection("EPSG:3857"),
	    				   		   controls: new OpenLayers.Control.Attribution(),
	    				   		   maxExtent: new OpenLayers.Bounds(-20037508.34,-20037508.34,20037508.34,20037508.34),
	    				   		   maxResolution: 156543.0339,
	    				   		   resolutions: [ 4891.969809375 ],
	    				   		   units: "m", 
    				   		     };
				
				// Build all the OpenLayers.Maps    			   		     		
		        var continentalMap = new OpenLayers.Map("map", continentalMapOptions);
		        var alaskaMap = new OpenLayers.Map("map", alaskaMapOptions);
		        var hawaiiMap = new OpenLayers.Map("map", hawaiiMapOptions);
		        globalMap = hawaiiMap;
		        
		        // Create the background layers		
		        var continentalLayer = new OpenLayers.Layer.WMS(
		            "Continents: Contiguous",
		            "http://50.19.88.63/arcgis/services/WorldBackground/MapServer/WMSServer",
		            { layers: ["0", "1"], 
		              format: "image/png" }
		        );
		        
		        var alaskaLayer = new OpenLayers.Layer.WMS(
		            "Continents: Alaska",
		            "http://50.19.88.63/arcgis/services/WorldBackground/MapServer/WMSServer",
		            { layers: ["0", "1"], 
		              format: "image/png" }
		        );
		        
		        var hawaiiLayer = new OpenLayers.Layer.WMS(
		            "Continents: Hawaii",
		            "http://50.19.88.63/arcgis/services/WorldBackground/MapServer/WMSServer",
		            { layers: ["0", "1"], 
		              format: "image/png" }
		        );
		        
		        // Create State foreground layers
		        var continentalStateLayer = new OpenLayers.Layer.WMS(
		        	"States: Contiguous",
		        	"http://localhost:8080/geoserver/wms",
		        	{ layers: ["aasg:StateContributionTracker"],
		        	  transparent: "true" }
		        );
		        
		        // Add the foreground layer to each map
				continentalMap.addLayer(continentalStateLayer);
				
		        // Add the background layer to each map
		        continentalMap.addLayer(continentalLayer);		        
		        alaskaMap.addLayer(alaskaLayer);
		        hawaiiMap.addLayer(hawaiiLayer);
				
				
				
				// Setup center coordinates for each map				
				var continentalCenterPoint = new OpenLayers.LonLat(-10591131, 4885637);
				var alaskaCenterPoint = new OpenLayers.LonLat(-16793594, 9376849);
				var hawaiiCenterPoint = new OpenLayers.LonLat(-17532836, 2356488);
				
				// Build GeoExt.MapPanels
				var marginValue = 5;
				var alaskaHeight = 200;
				var hawaiiHeight = 125;
				
		        var continentalMapPanel = new GeoExt.MapPanel({	
		            map: continentalMap,
		            title: "State Geothermal Data Contribution Status",
		            center: continentalCenterPoint,
		            height: 768,
		            width: 1024,
		            x: 0,
		            y: 0,
		        });		        		   
		        
		        var alaskaMapPanel = new GeoExt.MapPanel({
		        	map: alaskaMap,		        	
		        	center: alaskaCenterPoint,
		        	width: 225,
		        	height: alaskaHeight,
		        	x: marginValue,
		        	y: continentalMapPanel.height - alaskaHeight - marginValue,
		        	bodyStyle: { border: "1px solid black" },
		        });
		        
		        var hawaiiMapPanel = new GeoExt.MapPanel({
		        	map: hawaiiMap,		        	
		        	center: hawaiiCenterPoint,
		        	width: 150,
		        	height: hawaiiHeight,
		        	x: marginValue + alaskaMapPanel.width + marginValue,
		        	y: continentalMapPanel.height - hawaiiHeight - marginValue,
		        	bodyStyle: { border: "1px solid black" },
		        });
		        
				// Build the Page Layout				
				var vp = new Ext.Viewport({
			        layout: "border",
			        renderTo: "map",
			        defaults: { autoScroll: true },			    
			        items: [ { layout: "absolute",
			        		   region: "center",
			        		   items: [ continentalMapPanel,
			        		 		    alaskaMapPanel,
			        		 			hawaiiMapPanel ]
			        		 }
			        	   ]	
		        });
		    });
		</script>
	    {% block scripts %}{% endblock %}
  	</head>
  	{% block body %}
  	<body>
  		<div id="map"></div>
	</body>
  	{% endblock %}
</html>